\section{Iteration 8: Decomposition of the Notification Unit}
\label{add:it8}

\subsection{Step 1: Identify candidate drivers}
\label{add:it8/drivers}

\npar There is only very little functionality delegated to this unit, namely one
two cases, UC9 (Notify Customer) and UCx (retrieve customer from deviceId).
Since there are no quality attributes this decomposition will be use case
driven.

\subsection{Step 2: Choose design concepts}
\label{add:it8/concepts}

\subsubsection{Tactics}
\label{add:it8/tactics}

\npar Since there are no applicable quality attributes in this iteration. There
are no tactics selected. Off course are general OO design principles such as
separation of concerns taken into account as much as possible.

\subsubsection{Design Patterns}
\label{add:it8/patterns}

\npar No patterns were found to develop the functionality of UC9.

\subsection{Step 3: Instantiate architectural elements and allocate responsibilities}
\label{add:it8/elements}

\begin{figure}[H]
	\begin{centering}
		% TODO Figure
		\includegraphics[width=\textwidth]{figs/add-it8-elements.pdf}
		\caption{Overview of the instantiated child elements in the Notification Unit}
		\label{fig:it8/elements}
	\end{centering}
\end{figure}

\npar There are two main components in this decomposition, the communication
client and the transport map. Both of them will be explained below. A graphical
illustration is given in figure \ref{fig:it8/elements}.

\subsubsection{CommunicationClient} 
% TODO: voor de emergency services moet er misschien een shortcut voorzien
% worden ipv de overhead om nog eerst het communication channel op te zoeken ?
\npar This component gets the initial notification message. It's task is
twofold. First of all this component has to fetch the communication channel
through which it has to contact the stakeholder (i.e. the emergency services
and/or one or more customers). Therefore it uses the
\interface{CustomerProfileAPI} interface of the database which contains all user
information. Secondly, once the channel is acquired it has to contact the
transport map to ask for the right transport unit which can be used to send the
notification. The transport map offers therefore an \interface{TransportMapAPI}
interface.

\subsubsection{Transport Map}

\npar The transport map is the manager of several transport components. The
map will return the right transport component based on the request. Each
transportcomponent is responsible for communication towards the stakeholders
through a specific channel. To realize this, each of these transport components
offers a \interface{TransportAPI} interface. By splitting the transport into
different components the sending of notifications can be parallelized (i.e. over
different communication channels).

\subsection{Step 4: Define interfaces for instantiated elements}
\label{add:it8/interfaces}

\npar In this section each interface is explained in terms of the components
which use and/or offer it together with information about what is exchanged. For
detailed information with reference to the specific methods the interfaces
implement, we refer to the interface catalog, see appendix
\ref{chap:interface-catalog}.

\subsubsection{NotificationAPI}

\npar The \interface{NotificationAPI} was already discussed in section
\ref{add:it1/interfaces}.

\subsubsection{TransportMapAPI}

\npar The \interface{TransportMapAPI} interface is situated in between the
CommunicationClient, which is the invoker, and TransportMap, which is the
provider. This interface offers functionality to retrieve a Transport entity.

\paragraph{TransportAPI}

\npar This interface is offered by Transport components. It is used to transport
notification towards stakeholders such as customers.

\begin{figure}[H]
	\begin{centering}
		% TODO Figure
		\includegraphics[width=\textwidth]{figs/add-it8-interfaces.pdf}
		\caption{Overview of the interfaces and components in the Notification Unit}
		\label{fig:it8/interfaces}
	\end{centering}
\end{figure}

\subsection{Step 5: Verify and refine}
\label{add:it8/verification}

\npar The driver of this iteration, UC9, is resolved. All the steps of its main
scenario are now tracable in the diagram.
